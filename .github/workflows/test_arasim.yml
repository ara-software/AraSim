name: test_arasim
on: [push]
jobs:
  build:
    runs-on: ubuntu-20.04
    steps:

      - uses: actions/checkout@v2

      - name: Install dependencies
        run: |
          sudo apt-get install dpkg-dev cmake g++ gcc binutils libx11-dev \
           libxpm-dev libxft-dev libxext-dev python libssl-dev libfftw3-dev libgsl-dev libboost-dev


      - name: Install ROOT
        run: |
          wget -q https://root.cern/download/root_v6.22.06.Linux-ubuntu20-x86_64-gcc9.3.tar.gz
          tar -xzf root_v6.22.06.Linux-ubuntu20-x86_64-gcc9.3.tar.gz
          source root/bin/thisroot.sh
          root --version


      - name: Install libRootFftwWrapper
        run: |

          source root/bin/thisroot.sh

          # download
          wget -q https://github.com/nichol77/libRootFftwWrapper/archive/master.tar.gz -O libRootFftwWrapper.tar.gz
          mkdir libRootFftwWrapper
          tar -xzf libRootFftwWrapper.tar.gz -C libRootFftwWrapper --strip-components=1
          rm libRootFftwWrapper.tar.gz
          

          # prepare to build
          cd libRootFftwWrapper
          sed -i 's:@ccmake:@cmake:' Makefile

          # now build
          make configure
          make
          sudo make install

      - name: Build AraSim
        run : |

          source root/bin/thisroot.sh
          cd AraSim
          make
          




